
@model IEnumerable<WebApplication4.Models.ProjectPeopleAllocations>

@{
    ViewBag.Title = "Index";
    var users = (List<WebApplication4.Models.AspNetUsers>)ViewBag.personID;
    var staff = (List<WebApplication4.Models.Staff>)ViewBag.staff;
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create", null, new { @class = "btn btn-primary" })
</p>

<br>
<script src="~/Scripts/jquery-3.4.1.js"></script>
<!--<script>
    $().ready(function () {
        var op = $("#StdORStff option:selected");
        alert($('#StdORStff option:selected').html())
    });

    $(function () {
        var val = $('select option:select').val();
        var sel = document.getElementById("StdORStff");
        var $slct = $("#StdORStff")
        var $std = $("#std")
        var $stff = $("#stff")


            if ($("#std").attr.is("selected") == true) {
                alert("1111");
            } else if ($("#stff").attr.is("selected") == true) {
                alert("2222");
            }




    })


</script>
<style type="text/css">
    .red{
        color:red;
        width:50px;
        height:50px;
    }
</style>
<div style="color:red;
        width:50px;
        height:50px;">

</div>-->

<form action="/ProjectPeopleAllocations/Index" method="post">

    <div class="row">

        <div class="col-md-6">


            <div class="row">
                <div class="col-md-4">
                    @Html.DropDownList("ddlyear", null, htmlAttributes: new { @class = "form-control" });
                </div>
                <div class="col-md-4">
                    @Html.DropDownList("DDLSemester", null, htmlAttributes: new { @class = "form-control" })
                </div>
                <div class="col-md-4">
                    <input type="submit" class="btn btn-primary" value="serch" />
                </div>
            </div>

            <br />
            <div style="height: 555px; overflow: auto;">

                <table class="table table-hover">
                    <tr>
                        <th>
                            Project No.
                        </th>
                        <th>
                            Project Title
                        </th>
                        <th>
                            Staff
                        </th>
                        <th>
                            Students
                        </th>


                        <th></th>
                    </tr>

                    @foreach (var item in Model)
                    {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Projects.projectID)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Projects.projectTitle)
                    </td>



                    <td>
                        <div>
                            <div id="staff @item.personID" ondrop="drop(event)" style="min-height:10px" ondragover="allowDrop(event)">



                                @*<div>@users.FirstOrDefault(p => p.personID == item.personID).UserName</div>*@
                            </div>

                        </div>
                    </td>
                    <td>
                        <div>
                            <div id="div @item.personID" ondrop="drop(event)" ondragover="allowDrop(event)" style="min-height:10px">
                                <div>@users.FirstOrDefault(p => p.personID == item.personID).UserName</div>
                            </div>



                        </div>
                    </td>
                    <td>

                        <!--   @Html.ActionLink("Edit", "Edit", new { projectID = item.projectID, personID = item.personID }, new { @class = "btn btn-primary" })
                             |
        @Html.ActionLink("Details", "Details", new { projectID = item.projectID, personID = item.personID }, new { @class = "btn btn-primary" }) |
             @Html.ActionLink("Delete", "Delete", new { projectID = item.projectID, personID = item.personID }, new { @class = "btn btn-primary" })-->

                    </td>
                </tr>
                    }

                </table>
            </div>

        </div>
        <div class="col-md-6">
            <h3>Filter</h3>
            <div class="row">
                <div class="col-md-5">
                    <select class="form-control" id="selopt" name="pop" onchange="selpt(this)">
                        @if (ViewBag.pop == "student")
                        {
                            <option value="student" selected>Students</option>
                            <option value="staff">Supervisors</option>
                        }
                        else
                        {
                            <option value="student">Students</option>
                            <option value="staff" selected>Supervisors</option>
                        }

                    </select>
                </div>

                <div class="col-md-5 stud" @ViewBag.hidden>
                    <select class=" form-control" name="StudyPlan">
                        <option label="All Plans" value="-1" selected="selected">All Plans</option>
                        <option label="planA" value="1">planA</option>
                        <option label="planB" value="2">planB</option>
                    </select>
                </div>
            </div>
            <br />
            <div class="row">

                <div class="col-md-5 stud" @ViewBag.hidden>


                    <select class="form-control">
                        <option value="all" selected="selected">All GPAs</option>
                        <option value=">0">Between 0.0 and 1.99</option>
                        <option value=">2">Between 2.0 and 2.99</option>
                        <option value=">3">Between 3.0 and 3.99</option>
                        <option value=">4">Between 4.0 and 4.99</option>
                        <option value=">5">Between 5.0 and 5.99</option>
                        <option value=">6">Between 6.0 and 7.0</option>
                        <option value="none">No GPA on record</option>
                    </select>

                </div>

                <div class="col-md-5 ">
                    <input class="form-control" type="text" name="name" value="" placeholder="Search" />
                </div>

            </div>
            <br />
            <input type="checkbox" name="name" value="" /> include allocated people
            <h3>Sort</h3>
            <div class="row">

                <div class="col-md-5">
                    <select class=" form-control" name="tyt" id="AscDropD">
                        <option value="value">
                        <option label="Name" value="fullName" selected >Name</option>
                        <option label="GPA" value="gpa">GPA</option>
                        <option label="Software Development with C++" value="105295">Software Development with C++</option>
                        <option label="Programming Fundamentals" value="105294">Programming Fundamentals</option>
                        <option label="Web Development" value="156783">Web Development</option>
                        <option label="Interface Desgin, Interaction and Experience" value="012540">Interface Desgin, Interaction and Experience</option>
                        <option label="Agile Development with .NET" value="105284">Agile Development with .NET</option>
                    </select>
                </div>


                <div class="col-md-5">
                    <input type="submit" class="btn btn-primary" value="ASC" onclick="Acs()" />
                    <input type="submit" class="btn btn-primary" value="DESC" onclick="Decs()" />

                </div>
                <input type="text" id ="AscDesc" name="namedesc" hidden />
            </div>

            <br />
            <div style="height: 555px; overflow: auto;">

                <table class="table table-hover stud" @ViewBag.hidden>
                    <tr>
                        <th>
                            Name
                        </th>
                        <th>
                            SDC++
                        </th>
                        <th>
                            PF
                        </th>

                        <th>
                            WEB
                        </th>
                        <th>
                            IDIE
                        </th>
                        <th>
                            AgNET
                        </th>
                        <th>
                            GPA
                        </th>
                    </tr>

                    @foreach (var csgd in ViewBag.stcs)
                    {
                        <tr id="idrag @csgd.ID">
                            <td>
                                @{ 

                                }
                                <div id="drag @csgd.ID" draggable="true" ondragstart="drag(event)"> @csgd.Name</div>
                            </td>

                            <td>
                                @{

                                    
                                        var grade = "";
                                        if (Convert.ToInt32(csgd.CPP) == 1)
                                        {
                                            grade = "HD";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 2)
                                        {
                                            grade = "D";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 3)
                                        {
                                            grade = "C";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 4)
                                        {
                                            grade = "P1";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 5)
                                        {
                                            grade = "P2";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 6)
                                        {
                                            grade = "F1";
                                        }
                                        else if (Convert.ToInt32(csgd.CPP) == 7)
                                        {
                                            grade = "F2";
                                        }
                                        @grade
                                    



                                }
                            </td>

                            <td>
                                @{
                                    
                                        var grade1 = "";
                                        if (Convert.ToInt32(csgd.PF) == 1)
                                        {
                                            grade1 = "HD";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 2)
                                        {
                                            grade1 = "D";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 3)
                                        {
                                            grade1 = "C";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 4)
                                        {
                                            grade1 = "P1";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 5)
                                        {
                                            grade1 = "P2";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 6)
                                        {
                                            grade1 = "F1";
                                        }
                                        else if (Convert.ToInt32(csgd.PF) == 7)
                                        {
                                            grade1 = "F2";
                                        }
                                        @grade1
                                    
                                }
                            </td>

                            <td>
                                @{
                                    
                                        var grade2 = "";
                                        if (Convert.ToInt32(csgd.WEB) == 1)
                                        {
                                            grade2 = "HD";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 2)
                                        {
                                            grade2 = "D";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 3)
                                        {
                                            grade2 = "C";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 4)
                                        {
                                            grade2 = "P1";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 5)
                                        {
                                            grade2 = "P2";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 6)
                                        {
                                            grade2 = "F1";
                                        }
                                        else if (Convert.ToInt32(csgd.WEB) == 7)
                                        {
                                            grade2 = "F2";
                                        }
                                        @grade2
                                    
                                }
                            </td>

                            <td>
                                @{
                                   
                                        var grade3 = "";
                                        if (Convert.ToInt32(csgd.IDIE) == 1)
                                        {
                                            grade3 = "HD";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 2)
                                        {
                                            grade3 = "D";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 3)
                                        {
                                            grade3 = "C";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 4)
                                        {
                                            grade3 = "P1";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 5)
                                        {
                                            grade3 = "P2";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 6)
                                        {
                                            grade3 = "F1";
                                        }
                                        else if (Convert.ToInt32(csgd.IDIE) == 7)
                                        {
                                            grade3 = "F2";
                                        }
                                        @grade3
                                    
                                }
                            </td>

                            <td>
                                @{
                                   
                                        var grade4 = "";
                                        if (Convert.ToInt32(csgd.AgNET) == 1)
                                        {
                                            grade4 = "HD";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 2)
                                        {
                                            grade4 = "D";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 3)
                                        {
                                            grade4 = "C";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 4)
                                        {
                                            grade4 = "P1";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 5)
                                        {
                                            grade4 = "P2";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 6)
                                        {
                                            grade4 = "F1";
                                        }
                                        else if (Convert.ToInt32(csgd.AgNET) == 7)
                                        {
                                            grade4 = "F2";
                                        }
                                        @grade4
                                    
                                }
                            </td>

                            <td>
                                @csgd.Gpa
                            </td>
                        </tr>
                    }

                </table>

                <table class="table table-hover staff" @ViewBag.staffHidden>
                    <tr>
                        <th>
                            Name
                        </th>

                        <th>
                            Allocated projects
                        </th>
                    </tr>

                    @foreach (var item in staff)
                    {
                        <tr id="istaff @item.staffID">
                            <td>
                                <div id="staff @item.staffID" draggable="true" ondragstart="drag(event)"> @item.username</div>
                            </td>

                            <td>
                                0
                            </td>
                        </tr>
                    }

                </table>

            </div>
        </div>

    </div>

</form>

<script>
    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
        ev.dataTransfer.setData("Text", ev.target.id);
    }

    function drop(ev) {
        ev.preventDefault(); var idstr = ev.currentTarget.getAttribute("id"); var po = document.getElementById("selopt").value; var data = ev.dataTransfer.getData("Text");
        if (po == 'student' && data.includes('drag') && idstr.includes('div')) {
            var str = document.getElementById("i" + data); str.setAttribute("hidden", "hidden");; ev.target.appendChild(document.getElementById(data));
        }
        if (po == 'staff' && data.includes('staff') && idstr.includes('staff')) {
            var str = document.getElementById("i" + data); str.setAttribute("hidden", "hidden");; ev.target.appendChild(document.getElementById(data));
        }


    }

    function selpt(params) {

        if (params.value != 'staff') {
            var strs = document.getElementsByClassName("stud");
            for (var i = 0; i < strs.length; i++) { strs[i].removeAttribute("hidden"); }; var strp = document.getElementsByClassName("staff");
            for (var i = 0; i < strp.length; i++) { strp[i].setAttribute("hidden", "true"); };

        } else {
            var strs = document.getElementsByClassName("stud"); for (var i = 0; i < strs.length; i++) { strs[i].setAttribute("hidden", "hidden"); };

            var strp = document.getElementsByClassName("staff"); for (var i = 0; i < strp.length; i++) { strp[i].removeAttribute("hidden"); };
        }


    }
    function Acs() {
        document.getElementById("AscDesc").value = "asc";
    }
    function Decs() {
        document.getElementById("AscDesc").value = "desc";
    }
        
   
</script>